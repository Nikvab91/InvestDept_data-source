#Документация

Демонстрационная база для построение отчетов по операционной деятельности.

##Общее описание БД
Структура базы состоит из двух схем. 
###Базовые схема
Первая схема Prestage схема в которой попадают данные из внешних источников. Процедура выгрузки работает 1 в 1, без какой либо обработки. Выгрузка осуществляется через csv файлы.
Вторая схема -  хранилище для построения отчетности -  схема operreport.
Во вторую схему процедура выгрузки работает для таблиц PL и 1с таблиц 1 в 1, а для Client Data (CDR) с помощью специальных процедур INSERT OR CONFLICT IGNORE.
Выгрузка в схему operreport производиться по событию загрузки в схему Prestage. После выгрузки данные для отчетности готовы.
БД построена по историческому принципу, она хранит все версии записей с каждого DumpDate.

###Источники данных
Oracle с таблицей данных по клиентам (CDR) и таблицей данных PL, и 1с бухгалтерскими агрегатами.

###Мапинг таблиц
Представлен в отдельном файле. NoName_mapping.ods

###Диаграмма данных
Представлена в отдельном фале. NoName.png

###Шаблоны view
Представлена в отдельном фале. NoName_v.sql

###DDL
Представлена в отдельном фале. NoName.sql

##Детальное описание БД

Модель БД построена по нормализованной схеме с использование сквозных наименований ID

##operreport.clients 

Основная таблица информации по клиентам.

 1. "ClientID" - идентификатор клиента. Формируется путем копирования из таблицы oradata_cdr.
 2.	"Active" - флаг активности клиента.
 3.	"DumpDate" - дата выгрузки из таблицы CDR. Равно DumpDate oradata_cdr.
 4.	"RegionID" - идентификатор региона.
 5. "LocalityID" - идентификатор местности.
 6.	"TariffID"  - идентификатор тарифа.
 7. "SubServiceID" - идетификатор сервиса.
 8. "SegmentGroup" - сегмент бизнеса.
 9.	"EquipRental"  - флаг типа продаж.
 10. "UserStatisticsID" - идетификатор набора клиентской статистики,
 11. "PLClientID" - связь с финансовыми данными.

##operreport.regions 

Справочник регионов.

1. "RegionID - идентификатор региона.
2.	"RegionCode" - код региона.

##operreport.localitys 

Спрвочник местностей. У региона много местностей.

1.	"LocalityID" - идентификатор местностей.
2.	"LocalityCode" - Код местности.
3.	"RegionID"  - Код региона
  
## operreport.statuses  
 Справочник клиентских статусов. Клиент может менять статусы.

1.	"StatusID" - идентификатор статуса.
2.	"StatusDesc" - описание статуса.
3.	"ClientID" - идентификатор клиента.

##operreport.tariffs 
Справочник тарифов. 

1.	"TariffID" - идентификатор тарифа.
2.	"TariffTitle" - описание тарифа.
3.	"ConnectionSpeed" - предустановленная скорость пользовательского соединения.
4.	"UsagePatterns"  - тип пользовательского поведения в сети.

## operreport.services
Справочник сервисов.

1.	"ServiceID" - идетификатор сервиса.
2.	"Service" - описание сервиса.

## operreport.subservices 
Справочник сабсервисов. У сервиса много сабсервисов.

1.	"SubServiceID" - идентификатор сабсервиса.
2.	"ServiceName" - название сабсервиса.
3.	"ServiceID" - идентификатор сервиса.

## operreport.userstatistics 
	Таблица пользовательской статистики. Потраченного трафика. Открытых тикетов за период и количества инциндентов с пользователем.

1. "UserStatisticsID" - идентификатор пользовательской статистики.
2.	"DataUsage" - объем потраченного трафика.
3.	"Outages" - количество открытых инциндентов.
4.	TSTickets" - количество открытых тикетов.

## operreport.expitems 
Таблица предоставленых услуг клиенту.
1.	"ExpItemID" - идентификатор услуги
2.	"ExpItemCode" - код услуги.
3.	"ExpItemDescr" - описание услуги.
4.	"ClientID" - идентификатор клиента.
	

